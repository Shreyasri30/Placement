package day_4;
import java.sql.*;

public class crud {

    static final String URL = "jdbc:mysql://localhost:3306/company";
    static final String USER = "root";  
    static final String PASS = "root";  

    public static void main(String[] args) {
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
            Connection conn = DriverManager.getConnection(URL, USER, PASS);
            System.out.println("Connected to MySQL database.");

            Statement stmt = conn.createStatement();

           
          
            try {
                stmt.executeUpdate("ALTER TABLE Worker ADD COLUMN Email VARCHAR(100)");
                System.out.println("Column 'Email' added successfully.");
            } catch (SQLException e) {
                System.out.println("Column 'Email' already exists.");
            }

          
            try {
                stmt.executeUpdate("ALTER TABLE Worker CHANGE COLUMN FirstName FName VARCHAR(50)");
                System.out.println("Column 'FirstName' renamed to 'FName' successfully.");
            } catch (SQLException e) {
                System.out.println("Column 'FirstName' is already renamed to 'FName'.");
            }

            String insertSQL = "INSERT INTO Worker (FName, LastName, Salary, Department, Email) VALUES (?, ?, ?, ?, ?)";
            PreparedStatement ps = conn.prepareStatement(insertSQL);
            ps.setString(1, "Rahul");
            ps.setString(2, "Kumar");
            ps.setInt(3, 60000);
            ps.setString(4, "HR");
            ps.setString(5, "rahul@example.com");
            ps.executeUpdate();
            System.out.println("Record inserted.");

          
            String updateSQL = "UPDATE Worker SET Salary = ? WHERE FName = ?";
            ps = conn.prepareStatement(updateSQL);
            ps.setInt(1, 70000);
            ps.setString(2, "Rahul");
            ps.executeUpdate();
            System.out.println("Record updated.");

         
            ResultSet rs = stmt.executeQuery("SELECT * FROM Worker");
            while(rs.next()) {
                System.out.println(rs.getInt("WorkerID") + " | " +
                                   rs.getString("FName") + " | " +
                                   rs.getString("LastName") + " | " +
                                   rs.getInt("Salary") + " | " +
                                   rs.getString("Department") + " | " +
                                   rs.getString("Email"));
            }

            
            String deleteSQL = "DELETE FROM Worker WHERE FName = ?";
            ps = conn.prepareStatement(deleteSQL);
            ps.setString(1, "Rahul");
            ps.executeUpdate();
            System.out.println("Record deleted.");

            conn.close();
            System.out.println("Connection closed.");

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
